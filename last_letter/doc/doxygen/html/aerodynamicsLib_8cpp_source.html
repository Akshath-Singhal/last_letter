<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>last_letter: aerodynamicsLib.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">


</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">aerodynamicsLib.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="aerodynamicsLib_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00002"></a>00002 <span class="comment">// Define Aerodynamics class</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a><a class="code" href="classAerodynamics.html#a0e340c9b71f523570fb9dbdf1298115d">00005</a> <a class="code" href="classAerodynamics.html#a0e340c9b71f523570fb9dbdf1298115d">Aerodynamics::Aerodynamics</a>(<a class="code" href="classModelPlane.html">ModelPlane</a> * parent)
<a name="l00006"></a>00006 {
<a name="l00007"></a>00007         <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a> = parent;
<a name="l00008"></a>00008         XmlRpc::XmlRpcValue list;
<a name="l00009"></a>00009         <span class="keywordtype">int</span> i;
<a name="l00010"></a>00010         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/CGOffset&quot;</span>, list)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -/airframe/CGOffset- in param server!&quot;</span>); ros::shutdown();}
<a name="l00011"></a>00011         <span class="keywordflow">for</span> (i = 0; i &lt; list.size(); ++i) {
<a name="l00012"></a>00012                 ROS_ASSERT(list[i].getType() == XmlRpc::XmlRpcValue::TypeDouble);
<a name="l00013"></a>00013         }
<a name="l00014"></a>00014         <a class="code" href="classAerodynamics.html#a18e80d012584f2c96968b1b29aa2ff29">CGOffset</a>.x = list[0];
<a name="l00015"></a>00015         <a class="code" href="classAerodynamics.html#a18e80d012584f2c96968b1b29aa2ff29">CGOffset</a>.y = list[1];
<a name="l00016"></a>00016         <a class="code" href="classAerodynamics.html#a18e80d012584f2c96968b1b29aa2ff29">CGOffset</a>.z = list[2];
<a name="l00017"></a>00017 }
<a name="l00018"></a>00018 
<a name="l00019"></a><a class="code" href="classAerodynamics.html#af0e048e0c80ec8334997b79b761fea60">00019</a> <a class="code" href="classAerodynamics.html#af0e048e0c80ec8334997b79b761fea60">Aerodynamics::~Aerodynamics</a>()
<a name="l00020"></a>00020 {
<a name="l00021"></a>00021         <span class="keyword">delete</span> <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>;
<a name="l00022"></a>00022 }
<a name="l00023"></a>00023 
<a name="l00025"></a>00025 <span class="comment">// Define NoAerodynamics class</span>
<a name="l00027"></a>00027 <span class="comment"></span>
<a name="l00028"></a>00028 <span class="comment">// Class constructor</span>
<a name="l00029"></a><a class="code" href="classNoAerodynamics.html#a88c56da053b6aeae1608f15412a7a96f">00029</a> <a class="code" href="classNoAerodynamics.html#a88c56da053b6aeae1608f15412a7a96f">NoAerodynamics::NoAerodynamics</a>(<a class="code" href="classModelPlane.html">ModelPlane</a> * parent) : <a class="code" href="classAerodynamics.html">Aerodynamics</a>(parent)
<a name="l00030"></a>00030 {
<a name="l00031"></a>00031         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force.x = 0.0;
<a name="l00032"></a>00032         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force.y = 0.0;
<a name="l00033"></a>00033         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force.z = 0.0;
<a name="l00034"></a>00034         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque.x = 0.0;
<a name="l00035"></a>00035         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque.y = 0.0;
<a name="l00036"></a>00036         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque.z = 0.0;
<a name="l00037"></a>00037 }
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="comment">// Class destructor</span>
<a name="l00040"></a><a class="code" href="classNoAerodynamics.html#a9bb30a1b8b4939d114c81abcc20884b0">00040</a> <a class="code" href="classNoAerodynamics.html#a9bb30a1b8b4939d114c81abcc20884b0">NoAerodynamics::~NoAerodynamics</a>()
<a name="l00041"></a>00041 {
<a name="l00042"></a>00042 }
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 <span class="comment">// Force calculation function</span>
<a name="l00045"></a><a class="code" href="classNoAerodynamics.html#ad680e3617c4945456629d5c90fa436a8">00045</a> geometry_msgs::Vector3 <a class="code" href="classNoAerodynamics.html#ad680e3617c4945456629d5c90fa436a8">NoAerodynamics::getForce</a>()
<a name="l00046"></a>00046 {
<a name="l00047"></a>00047         <span class="keywordflow">return</span> <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force;
<a name="l00048"></a>00048 }
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 <span class="comment">// Torque calculation function</span>
<a name="l00051"></a><a class="code" href="classNoAerodynamics.html#a84d1cf44864c283307128d5c8168f03f">00051</a> geometry_msgs::Vector3 <a class="code" href="classNoAerodynamics.html#a84d1cf44864c283307128d5c8168f03f">NoAerodynamics::getTorque</a>()
<a name="l00052"></a>00052 {
<a name="l00053"></a>00053         <span class="keywordflow">return</span> <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque;
<a name="l00054"></a>00054 }
<a name="l00055"></a>00055 
<a name="l00057"></a>00057 <span class="comment">// Define StdLinearAero class</span>
<a name="l00059"></a>00059 <span class="comment"></span>
<a name="l00060"></a>00060 <span class="comment">// Class constructor</span>
<a name="l00061"></a><a class="code" href="classStdLinearAero.html#aa8d4225eec3de04d74234372722b8a99">00061</a> <a class="code" href="classStdLinearAero.html#aa8d4225eec3de04d74234372722b8a99">StdLinearAero::StdLinearAero</a>(<a class="code" href="classModelPlane.html">ModelPlane</a> * parent) : <a class="code" href="classAerodynamics.html">Aerodynamics</a>(parent)
<a name="l00062"></a>00062 {
<a name="l00063"></a>00063         <span class="comment">// Read aerodynamic coefficients from parameter server</span>
<a name="l00064"></a>00064         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_lift_q&quot;</span>, <a class="code" href="classStdLinearAero.html#afea0f2869e71f653aa1e7bc424aa9e21">c_lift_q</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_lift_q- in param server!&quot;</span>); ros::shutdown();}
<a name="l00065"></a>00065         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_lift_deltae&quot;</span>, <a class="code" href="classStdLinearAero.html#ac26808efa8a121e24fe5625b2e8b37a5">c_lift_deltae</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_lift_deltae- in param server!&quot;</span>); ros::shutdown();}
<a name="l00066"></a>00066         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_drag_q&quot;</span>, <a class="code" href="classStdLinearAero.html#afea0f2869e71f653aa1e7bc424aa9e21">c_lift_q</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_drag_q- in param server!&quot;</span>); ros::shutdown();}
<a name="l00067"></a>00067         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_drag_deltae&quot;</span>, <a class="code" href="classStdLinearAero.html#a5e332c16883474b374e69a5edcef2b9c">c_drag_deltae</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_drag_deltae- in param server!&quot;</span>); ros::shutdown();}
<a name="l00068"></a>00068         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c&quot;</span>, <a class="code" href="classStdLinearAero.html#a8c16a291b721df63de1b0a7b3682a6b6">c</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c- in param server!&quot;</span>); ros::shutdown();}
<a name="l00069"></a>00069         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/b&quot;</span>, <a class="code" href="classStdLinearAero.html#acdb1d08b964aff4f3bfe6c0d16710020">b</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -b- in param server!&quot;</span>); ros::shutdown();}
<a name="l00070"></a>00070         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/s&quot;</span>, <a class="code" href="classStdLinearAero.html#a5cb827e9556c8a872e0333c9c6e009d9">s</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -s- in param server!&quot;</span>); ros::shutdown();}
<a name="l00071"></a>00071         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_y_0&quot;</span>, <a class="code" href="classStdLinearAero.html#aa7aaa5b59110d6e17f862d90d2c0aadd">c_y_0</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_y_0- in param server!&quot;</span>); ros::shutdown();}
<a name="l00072"></a>00072         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_y_b&quot;</span>, <a class="code" href="classStdLinearAero.html#ac0bf180147c3ae4e69a37941d64cbec7">c_y_b</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_y_b- in param server!&quot;</span>); ros::shutdown();}
<a name="l00073"></a>00073         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_y_p&quot;</span>, <a class="code" href="classStdLinearAero.html#ae3b79be7850e46a8fdc63735ce34642a">c_y_p</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_y_p- in param server!&quot;</span>); ros::shutdown();}
<a name="l00074"></a>00074         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_y_r&quot;</span>, <a class="code" href="classStdLinearAero.html#ae4e6edb77ac3426778cf9eb278855b33">c_y_r</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_y_r- in param server!&quot;</span>); ros::shutdown();}
<a name="l00075"></a>00075         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_y_deltaa&quot;</span>, <a class="code" href="classStdLinearAero.html#ae5b7c7dcc0eb3428ea09cc01fac8612f">c_y_deltaa</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_y_deltaa- in param server!&quot;</span>); ros::shutdown();}
<a name="l00076"></a>00076         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_y_deltar&quot;</span>, <a class="code" href="classStdLinearAero.html#a4fd8c693c2c7e918d760c6628bdeccde">c_y_deltar</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_y_deltar- in param server!&quot;</span>); ros::shutdown();}
<a name="l00077"></a>00077         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_l_0&quot;</span>, <a class="code" href="classStdLinearAero.html#af553529715bdf31cf65a2944b5bb7df1">c_l_0</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_l_0- in param server!&quot;</span>); ros::shutdown();}
<a name="l00078"></a>00078         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_l_b&quot;</span>, <a class="code" href="classStdLinearAero.html#a7c7c5a9c48988dd444184fcc245e38ae">c_l_b</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_l_b- in param server!&quot;</span>); ros::shutdown();}
<a name="l00079"></a>00079         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_l_p&quot;</span>, <a class="code" href="classStdLinearAero.html#a44eb6a37e21c3f8a2643bcce02ad9a04">c_l_p</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_l_p- in param server!&quot;</span>); ros::shutdown();}
<a name="l00080"></a>00080         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_l_r&quot;</span>, <a class="code" href="classStdLinearAero.html#a88ea30ccd7c29d653dd7d4649697a803">c_l_r</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_l_r- in param server!&quot;</span>); ros::shutdown();}
<a name="l00081"></a>00081         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_l_deltaa&quot;</span>, <a class="code" href="classStdLinearAero.html#a3f7ed78effc2d855844bd090e63d3cf8">c_l_deltaa</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_l_deltaa- in param server!&quot;</span>); ros::shutdown();}
<a name="l00082"></a>00082         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_l_deltar&quot;</span>, <a class="code" href="classStdLinearAero.html#a0b219c0eb165ccf86dfdc61a5de8c1d2">c_l_deltar</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_l_deltar- in param server!&quot;</span>); ros::shutdown();}
<a name="l00083"></a>00083         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_m_0&quot;</span>, <a class="code" href="classStdLinearAero.html#ac4144afc949697cf9f0039eadaefd6b7">c_m_0</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_m_0- in param server!&quot;</span>); ros::shutdown();}
<a name="l00084"></a>00084         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_m_a&quot;</span>, <a class="code" href="classStdLinearAero.html#a87dacc14fbaa7657598ce943205ad303">c_m_a</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_m_a- in param server!&quot;</span>); ros::shutdown();}
<a name="l00085"></a>00085         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_m_q&quot;</span>, <a class="code" href="classStdLinearAero.html#aac04aa4a5a3577d12e7f16e2812362b9">c_m_q</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_m_q- in param server!&quot;</span>); ros::shutdown();}
<a name="l00086"></a>00086         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_m_deltae&quot;</span>, <a class="code" href="classStdLinearAero.html#a85d5ca2641c08586bcde536292cd08a5">c_m_deltae</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_m_deltae- in param server!&quot;</span>); ros::shutdown();}
<a name="l00087"></a>00087         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_n_0&quot;</span>, <a class="code" href="classStdLinearAero.html#aba9385395c79d07374cdd8c9b9b91d1e">c_n_0</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_n_0- in param server!&quot;</span>); ros::shutdown();}
<a name="l00088"></a>00088         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_n_b&quot;</span>, <a class="code" href="classStdLinearAero.html#a25aab18deeea9a21e3c049d9fa7ac9c3">c_n_b</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_n_b- in param server!&quot;</span>); ros::shutdown();}
<a name="l00089"></a>00089         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_n_p&quot;</span>, <a class="code" href="classStdLinearAero.html#affc180aa3cf1a8b649b51e75c60424ca">c_n_p</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_n_p- in param server!&quot;</span>); ros::shutdown();}
<a name="l00090"></a>00090         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_n_r&quot;</span>, <a class="code" href="classStdLinearAero.html#a1f8aac42ccdc9b248f78282c86c389c2">c_n_r</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_n_r- in param server!&quot;</span>); ros::shutdown();}
<a name="l00091"></a>00091         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_n_deltaa&quot;</span>, <a class="code" href="classStdLinearAero.html#a2431fd9eb77e9dd160d8384a97b0b952">c_n_deltaa</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_n_deltaa- in param server!&quot;</span>); ros::shutdown();}
<a name="l00092"></a>00092         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_n_deltar&quot;</span>, <a class="code" href="classStdLinearAero.html#a9981870bff6e0a825bf8d76f222a9a0e">c_n_deltar</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_n_deltar- in param server!&quot;</span>); ros::shutdown();}
<a name="l00093"></a>00093         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_drag_p&quot;</span>, <a class="code" href="classStdLinearAero.html#ab01ad99b489c74890ff52a93ccff9b1f">c_drag_p</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_drag_p- in param server!&quot;</span>); ros::shutdown();}
<a name="l00094"></a>00094         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_lift_0&quot;</span>, <a class="code" href="classStdLinearAero.html#a7a52af9ef946a13f1a9ed81e0d767a18">c_lift_0</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_lift_0- in param server!&quot;</span>); ros::shutdown();}
<a name="l00095"></a>00095         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/c_lift_a&quot;</span>, <a class="code" href="classStdLinearAero.html#ae19f9442a7fce39c46bf625732690b1d">c_lift_a0</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -c_lift_a- in param server!&quot;</span>); ros::shutdown();}
<a name="l00096"></a>00096         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;/environment/oswald&quot;</span>, <a class="code" href="classStdLinearAero.html#a808e6e818b50967cfb2eb710fad6a52b">oswald</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -oswald- in param server!&quot;</span>); ros::shutdown();}
<a name="l00097"></a>00097         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/mcoeff&quot;</span>, <a class="code" href="classStdLinearAero.html#a992de56d4c416bdd05d5aea9e3d98509">M</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -mcoeff- in param server!&quot;</span>); ros::shutdown();}
<a name="l00098"></a>00098         <span class="keywordflow">if</span>(!ros::param::getCached(<span class="stringliteral">&quot;airframe/alpha_stall&quot;</span>, <a class="code" href="classStdLinearAero.html#ad95e7fc62f2d7f7a5f559626fcc1a638">alpha0</a>)) {ROS_FATAL(<span class="stringliteral">&quot;Invalid parameters for -alpha_stall- in param server!&quot;</span>); ros::shutdown();}
<a name="l00099"></a>00099 }
<a name="l00100"></a>00100 
<a name="l00101"></a>00101 <span class="comment">// Class destructor</span>
<a name="l00102"></a><a class="code" href="classStdLinearAero.html#aa602a7d4ea025d21cce3aae600138ca2">00102</a> <a class="code" href="classStdLinearAero.html#aa602a7d4ea025d21cce3aae600138ca2">StdLinearAero::~StdLinearAero</a>()
<a name="l00103"></a>00103 {
<a name="l00104"></a>00104 }
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 <span class="comment">// Force calculation function</span>
<a name="l00107"></a><a class="code" href="classStdLinearAero.html#a60bfa24e89c142c67cc9362cbf3a1294">00107</a> geometry_msgs::Vector3 <a class="code" href="classStdLinearAero.html#a60bfa24e89c142c67cc9362cbf3a1294">StdLinearAero::getForce</a>()
<a name="l00108"></a>00108 {
<a name="l00109"></a>00109         <span class="comment">//split control input values</span>
<a name="l00110"></a>00110         <span class="keywordtype">double</span> deltaa = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#ac41ad9e857dd5482e12252657ea8a4ce">input</a>[0];
<a name="l00111"></a>00111         <span class="keywordtype">double</span> deltae = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#ac41ad9e857dd5482e12252657ea8a4ce">input</a>[1];
<a name="l00112"></a>00112         <span class="keywordtype">double</span> deltat = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#ac41ad9e857dd5482e12252657ea8a4ce">input</a>[2];
<a name="l00113"></a>00113         <span class="keywordtype">double</span> deltar = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#ac41ad9e857dd5482e12252657ea8a4ce">input</a>[3];
<a name="l00114"></a>00114 
<a name="l00115"></a>00115         <span class="comment">// Read airdata</span>
<a name="l00116"></a>00116         <span class="keywordtype">double</span> airspeed = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#acc744930c5692e9e12563f9bd22f8133">airdata</a>.<a class="code" href="classAirdata.html#a5a24d6ffec10fc3b4fb03c68740054c1">airspeed</a>;
<a name="l00117"></a>00117         <span class="keywordtype">double</span> alpha = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#acc744930c5692e9e12563f9bd22f8133">airdata</a>.<a class="code" href="classAirdata.html#a5387d66d4cf3a476de32da234ab97460">alpha</a>;
<a name="l00118"></a>00118         <span class="keywordtype">double</span> beta = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#acc744930c5692e9e12563f9bd22f8133">airdata</a>.<a class="code" href="classAirdata.html#aa61767f8ff9b8304c9a522473999d6a5">beta</a>;
<a name="l00119"></a>00119 
<a name="l00120"></a>00120         <span class="comment">// Read air density</span>
<a name="l00121"></a>00121         <a class="code" href="classStdLinearAero.html#a9de16b79bf25f3abec2f6d9ddb96c056">rho</a> = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#a3659963ee4b42cf72492096e6dd02f01">environment</a>.density;
<a name="l00122"></a>00122 
<a name="l00123"></a>00123         <span class="comment">//request lift and drag alpha-coefficients from the corresponding functions</span>
<a name="l00124"></a>00124         <span class="keywordtype">double</span> c_lift_a = <a class="code" href="classStdLinearAero.html#a715cbaf04dc8b7a9c4ce4d5bf194ec8f">liftCoeff</a>(alpha);
<a name="l00125"></a>00125         <span class="keywordtype">double</span> c_drag_a = <a class="code" href="classStdLinearAero.html#abb5b4b7352fd1ba4009844d0b66b1d11">dragCoeff</a>(alpha);
<a name="l00126"></a>00126 
<a name="l00127"></a>00127         <span class="comment">//convert coefficients to the body frame</span>
<a name="l00128"></a>00128         <span class="keywordtype">double</span> c_x_a = -c_drag_a*cos(alpha)+c_lift_a*sin(alpha);
<a name="l00129"></a>00129         <span class="keywordtype">double</span> c_x_q = -<a class="code" href="classStdLinearAero.html#a5e41ffacf728784aaffd906e5d35595d">c_drag_q</a>*cos(alpha)+<a class="code" href="classStdLinearAero.html#afea0f2869e71f653aa1e7bc424aa9e21">c_lift_q</a>*sin(alpha);
<a name="l00130"></a>00130         <span class="keywordtype">double</span> c_z_a = -c_drag_a*sin(alpha)-c_lift_a*cos(alpha);
<a name="l00131"></a>00131         <span class="keywordtype">double</span> c_z_q = -<a class="code" href="classStdLinearAero.html#a5e41ffacf728784aaffd906e5d35595d">c_drag_q</a>*sin(alpha)-<a class="code" href="classStdLinearAero.html#afea0f2869e71f653aa1e7bc424aa9e21">c_lift_q</a>*cos(alpha);
<a name="l00132"></a>00132 
<a name="l00133"></a>00133         <span class="comment">//read orientation</span>
<a name="l00134"></a>00134         geometry_msgs::Quaternion quat = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#aedc4b75173e6c55ba63c9c972b70bb9c">states</a>.pose.orientation;
<a name="l00135"></a>00135 
<a name="l00136"></a>00136         <span class="comment">//read angular rates</span>
<a name="l00137"></a>00137         <span class="keywordtype">double</span> p = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#aedc4b75173e6c55ba63c9c972b70bb9c">states</a>.velocity.angular.x;
<a name="l00138"></a>00138         <span class="keywordtype">double</span> q = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#aedc4b75173e6c55ba63c9c972b70bb9c">states</a>.velocity.angular.y;
<a name="l00139"></a>00139         <span class="keywordtype">double</span> r = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#aedc4b75173e6c55ba63c9c972b70bb9c">states</a>.velocity.angular.z;
<a name="l00140"></a>00140 
<a name="l00141"></a>00141         <span class="comment">//calculate aerodynamic force</span>
<a name="l00142"></a>00142         <span class="keywordtype">double</span> qbar = 1.0/2.0*<a class="code" href="classStdLinearAero.html#a9de16b79bf25f3abec2f6d9ddb96c056">rho</a>*pow(airspeed,2)*<a class="code" href="classStdLinearAero.html#a5cb827e9556c8a872e0333c9c6e009d9">s</a>; <span class="comment">//Calculate dynamic pressure</span>
<a name="l00143"></a>00143         <span class="keywordtype">double</span> ax, ay, az;
<a name="l00144"></a>00144         <span class="keywordflow">if</span> (airspeed==0)
<a name="l00145"></a>00145         {
<a name="l00146"></a>00146                 ax = 0;
<a name="l00147"></a>00147                 ay = 0;
<a name="l00148"></a>00148                 az = 0;
<a name="l00149"></a>00149         }
<a name="l00150"></a>00150         <span class="keywordflow">else</span>
<a name="l00151"></a>00151         {
<a name="l00152"></a>00152                 ax = qbar*(c_x_a + c_x_q*<a class="code" href="classStdLinearAero.html#a8c16a291b721df63de1b0a7b3682a6b6">c</a>*q/(2*airspeed) - <a class="code" href="classStdLinearAero.html#a5e332c16883474b374e69a5edcef2b9c">c_drag_deltae</a>*cos(alpha)*fabs(deltae) + <a class="code" href="classStdLinearAero.html#ac26808efa8a121e24fe5625b2e8b37a5">c_lift_deltae</a>*sin(alpha)*deltae);
<a name="l00153"></a>00153                 <span class="comment">// split c_x_deltae to include &quot;abs&quot; term</span>
<a name="l00154"></a>00154                 ay = qbar*(<a class="code" href="classStdLinearAero.html#aa7aaa5b59110d6e17f862d90d2c0aadd">c_y_0</a> + <a class="code" href="classStdLinearAero.html#ac0bf180147c3ae4e69a37941d64cbec7">c_y_b</a>*beta + <a class="code" href="classStdLinearAero.html#ae3b79be7850e46a8fdc63735ce34642a">c_y_p</a>*<a class="code" href="classStdLinearAero.html#acdb1d08b964aff4f3bfe6c0d16710020">b</a>*p/(2*airspeed) + <a class="code" href="classStdLinearAero.html#ae4e6edb77ac3426778cf9eb278855b33">c_y_r</a>*<a class="code" href="classStdLinearAero.html#acdb1d08b964aff4f3bfe6c0d16710020">b</a>*r/(2*airspeed) + <a class="code" href="classStdLinearAero.html#ae5b7c7dcc0eb3428ea09cc01fac8612f">c_y_deltaa</a>*deltaa + <a class="code" href="classStdLinearAero.html#a4fd8c693c2c7e918d760c6628bdeccde">c_y_deltar</a>*deltar);
<a name="l00155"></a>00155                 az = qbar*(c_z_a + c_z_q*<a class="code" href="classStdLinearAero.html#a8c16a291b721df63de1b0a7b3682a6b6">c</a>*q/(2*airspeed) - <a class="code" href="classStdLinearAero.html#a5e332c16883474b374e69a5edcef2b9c">c_drag_deltae</a>*sin(alpha)*fabs(deltae) - <a class="code" href="classStdLinearAero.html#ac26808efa8a121e24fe5625b2e8b37a5">c_lift_deltae</a>*cos(alpha)*deltae);
<a name="l00156"></a>00156                 <span class="comment">// split c_z_deltae to include &quot;abs&quot; term</span>
<a name="l00157"></a>00157         }
<a name="l00158"></a>00158 
<a name="l00159"></a>00159         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force.x = ax;
<a name="l00160"></a>00160         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force.y = ay;
<a name="l00161"></a>00161         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force.z = az;
<a name="l00162"></a>00162 
<a name="l00163"></a>00163         <span class="comment">// Printouts</span>
<a name="l00164"></a>00164         <span class="comment">// std::cout &lt;&lt; deltar &lt;&lt; &quot; &quot;;</span>
<a name="l00165"></a>00165         <span class="comment">// std::cout &lt;&lt; rho &lt;&lt; &quot; &quot;;</span>
<a name="l00166"></a>00166         <span class="comment">// std::cout &lt;&lt; airspeed &lt;&lt; &quot; &quot;;</span>
<a name="l00167"></a>00167         <span class="comment">// std::cout &lt;&lt; pow(airspeed,2) &lt;&lt; &quot; &quot;;</span>
<a name="l00168"></a>00168         <span class="comment">// std::cout &lt;&lt; s&lt;&lt; &quot; &quot;;</span>
<a name="l00169"></a>00169         <span class="comment">// std::cout &lt;&lt; alpha &lt;&lt; &quot; &quot;;</span>
<a name="l00170"></a>00170         <span class="comment">// std::cout &lt;&lt; c_lift_a &lt;&lt; &quot; &quot;;</span>
<a name="l00171"></a>00171         <span class="comment">// std::cout &lt;&lt; c_drag_a &lt;&lt; &quot; &quot;;</span>
<a name="l00172"></a>00172         <span class="comment">// std::cout &lt;&lt; c_x_a &lt;&lt; &quot; &quot;;</span>
<a name="l00173"></a>00173         <span class="comment">// std::cout&lt;&lt; ay &lt;&lt; std::endl;</span>
<a name="l00174"></a>00174 
<a name="l00175"></a>00175         <span class="keywordflow">return</span> <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force;
<a name="l00176"></a>00176 }
<a name="l00177"></a>00177 
<a name="l00178"></a>00178 <span class="comment">// Torque calculation function</span>
<a name="l00179"></a><a class="code" href="classStdLinearAero.html#a3ca07312f367b636cfded421394ccc73">00179</a> geometry_msgs::Vector3 <a class="code" href="classStdLinearAero.html#a3ca07312f367b636cfded421394ccc73">StdLinearAero::getTorque</a>()
<a name="l00180"></a>00180 {
<a name="l00181"></a>00181         <span class="comment">//split control input values</span>
<a name="l00182"></a>00182         <span class="keywordtype">double</span> deltaa = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#ac41ad9e857dd5482e12252657ea8a4ce">input</a>[0];
<a name="l00183"></a>00183         <span class="keywordtype">double</span> deltae = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#ac41ad9e857dd5482e12252657ea8a4ce">input</a>[1];
<a name="l00184"></a>00184         <span class="keywordtype">double</span> deltat = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#ac41ad9e857dd5482e12252657ea8a4ce">input</a>[2];
<a name="l00185"></a>00185         <span class="keywordtype">double</span> deltar = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#ac41ad9e857dd5482e12252657ea8a4ce">input</a>[3];
<a name="l00186"></a>00186 
<a name="l00187"></a>00187         <span class="comment">// Read airdata</span>
<a name="l00188"></a>00188         <span class="keywordtype">double</span> airspeed = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#acc744930c5692e9e12563f9bd22f8133">airdata</a>.<a class="code" href="classAirdata.html#a5a24d6ffec10fc3b4fb03c68740054c1">airspeed</a>;
<a name="l00189"></a>00189         <span class="keywordtype">double</span> alpha = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#acc744930c5692e9e12563f9bd22f8133">airdata</a>.<a class="code" href="classAirdata.html#a5387d66d4cf3a476de32da234ab97460">alpha</a>;
<a name="l00190"></a>00190         <span class="keywordtype">double</span> beta = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#acc744930c5692e9e12563f9bd22f8133">airdata</a>.<a class="code" href="classAirdata.html#aa61767f8ff9b8304c9a522473999d6a5">beta</a>;
<a name="l00191"></a>00191 
<a name="l00192"></a>00192         <span class="comment">// Read air density</span>
<a name="l00193"></a>00193         <a class="code" href="classStdLinearAero.html#a9de16b79bf25f3abec2f6d9ddb96c056">rho</a> = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#a3659963ee4b42cf72492096e6dd02f01">environment</a>.density;
<a name="l00194"></a>00194 
<a name="l00195"></a>00195         <span class="comment">//read angular rates</span>
<a name="l00196"></a>00196         <span class="keywordtype">double</span> p = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#aedc4b75173e6c55ba63c9c972b70bb9c">states</a>.velocity.angular.x;
<a name="l00197"></a>00197         <span class="keywordtype">double</span> q = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#aedc4b75173e6c55ba63c9c972b70bb9c">states</a>.velocity.angular.y;
<a name="l00198"></a>00198         <span class="keywordtype">double</span> r = <a class="code" href="classAerodynamics.html#ae80ecfb113e0bf12e28ff91d7b222151">parentObj</a>-&gt;<a class="code" href="classModelPlane.html#aedc4b75173e6c55ba63c9c972b70bb9c">states</a>.velocity.angular.z;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200         <span class="comment">//calculate aerodynamic torque</span>
<a name="l00201"></a>00201         <span class="keywordtype">double</span> qbar = 1.0/2.0*<a class="code" href="classStdLinearAero.html#a9de16b79bf25f3abec2f6d9ddb96c056">rho</a>*pow(airspeed,2)*<a class="code" href="classStdLinearAero.html#a5cb827e9556c8a872e0333c9c6e009d9">s</a>; <span class="comment">//Calculate dynamic pressure</span>
<a name="l00202"></a>00202         <span class="keywordtype">double</span> la, na, ma;
<a name="l00203"></a>00203         <span class="keywordflow">if</span> (airspeed==0)
<a name="l00204"></a>00204         {
<a name="l00205"></a>00205                 la = 0;
<a name="l00206"></a>00206                 ma = 0;
<a name="l00207"></a>00207                 na = 0;
<a name="l00208"></a>00208         }
<a name="l00209"></a>00209         <span class="keywordflow">else</span>
<a name="l00210"></a>00210         {
<a name="l00211"></a>00211                 la = qbar*<a class="code" href="classStdLinearAero.html#acdb1d08b964aff4f3bfe6c0d16710020">b</a>*(<a class="code" href="classStdLinearAero.html#af553529715bdf31cf65a2944b5bb7df1">c_l_0</a> + <a class="code" href="classStdLinearAero.html#a7c7c5a9c48988dd444184fcc245e38ae">c_l_b</a>*beta + <a class="code" href="classStdLinearAero.html#a44eb6a37e21c3f8a2643bcce02ad9a04">c_l_p</a>*<a class="code" href="classStdLinearAero.html#acdb1d08b964aff4f3bfe6c0d16710020">b</a>*p/(2*airspeed) + <a class="code" href="classStdLinearAero.html#a88ea30ccd7c29d653dd7d4649697a803">c_l_r</a>*<a class="code" href="classStdLinearAero.html#acdb1d08b964aff4f3bfe6c0d16710020">b</a>*r/(2*airspeed) + <a class="code" href="classStdLinearAero.html#a3f7ed78effc2d855844bd090e63d3cf8">c_l_deltaa</a>*deltaa + <a class="code" href="classStdLinearAero.html#a0b219c0eb165ccf86dfdc61a5de8c1d2">c_l_deltar</a>*deltar);
<a name="l00212"></a>00212                 ma = qbar*<a class="code" href="classStdLinearAero.html#a8c16a291b721df63de1b0a7b3682a6b6">c</a>*(<a class="code" href="classStdLinearAero.html#ac4144afc949697cf9f0039eadaefd6b7">c_m_0</a> + <a class="code" href="classStdLinearAero.html#a87dacc14fbaa7657598ce943205ad303">c_m_a</a>*alpha + <a class="code" href="classStdLinearAero.html#aac04aa4a5a3577d12e7f16e2812362b9">c_m_q</a>*<a class="code" href="classStdLinearAero.html#a8c16a291b721df63de1b0a7b3682a6b6">c</a>*q/(2*airspeed) + <a class="code" href="classStdLinearAero.html#a85d5ca2641c08586bcde536292cd08a5">c_m_deltae</a>*deltae);
<a name="l00213"></a>00213                 na = qbar*<a class="code" href="classStdLinearAero.html#acdb1d08b964aff4f3bfe6c0d16710020">b</a>*(<a class="code" href="classStdLinearAero.html#aba9385395c79d07374cdd8c9b9b91d1e">c_n_0</a> + <a class="code" href="classStdLinearAero.html#a25aab18deeea9a21e3c049d9fa7ac9c3">c_n_b</a>*beta + <a class="code" href="classStdLinearAero.html#affc180aa3cf1a8b649b51e75c60424ca">c_n_p</a>*<a class="code" href="classStdLinearAero.html#acdb1d08b964aff4f3bfe6c0d16710020">b</a>*p/(2*airspeed) + <a class="code" href="classStdLinearAero.html#a1f8aac42ccdc9b248f78282c86c389c2">c_n_r</a>*<a class="code" href="classStdLinearAero.html#acdb1d08b964aff4f3bfe6c0d16710020">b</a>*r/(2*airspeed) + <a class="code" href="classStdLinearAero.html#a2431fd9eb77e9dd160d8384a97b0b952">c_n_deltaa</a>*deltaa + <a class="code" href="classStdLinearAero.html#a9981870bff6e0a825bf8d76f222a9a0e">c_n_deltar</a>*deltar);
<a name="l00214"></a>00214         }
<a name="l00215"></a>00215 
<a name="l00216"></a>00216         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque.x = la;
<a name="l00217"></a>00217         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque.y = ma;
<a name="l00218"></a>00218         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque.z = na;
<a name="l00219"></a>00219 
<a name="l00220"></a>00220         <span class="comment">// Add torque to to force misalignment with CG</span>
<a name="l00221"></a>00221         <span class="comment">// r x F, where r is the distance from CoG to CoL</span>
<a name="l00222"></a>00222         <span class="comment">// Will potentially add the following code in the future, to support shift of CoG mid-flight</span>
<a name="l00223"></a>00223         <span class="comment">// XmlRpc::XmlRpcValue list;</span>
<a name="l00224"></a>00224         <span class="comment">// int i;</span>
<a name="l00225"></a>00225         <span class="comment">// if(!ros::param::getCached(&quot;airframe/CGOffset&quot;, list)) {ROS_FATAL(&quot;Invalid parameters for -/airframe/CGOffset- in param server!&quot;); ros::shutdown();}</span>
<a name="l00226"></a>00226         <span class="comment">// for (i = 0; i &lt; list.size(); ++i) {</span>
<a name="l00227"></a>00227         <span class="comment">//      ROS_ASSERT(list[i].getType() == XmlRpc::XmlRpcValue::TypeDouble);</span>
<a name="l00228"></a>00228         <span class="comment">//      CGOffset[i]=list[i];</span>
<a name="l00229"></a>00229         <span class="comment">// }</span>
<a name="l00230"></a>00230         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque.x = <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque.x + <a class="code" href="classAerodynamics.html#a18e80d012584f2c96968b1b29aa2ff29">CGOffset</a>.y*<a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force.z - <a class="code" href="classAerodynamics.html#a18e80d012584f2c96968b1b29aa2ff29">CGOffset</a>.z*<a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force.y;
<a name="l00231"></a>00231         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque.y = <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque.y - <a class="code" href="classAerodynamics.html#a18e80d012584f2c96968b1b29aa2ff29">CGOffset</a>.x*<a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force.z + <a class="code" href="classAerodynamics.html#a18e80d012584f2c96968b1b29aa2ff29">CGOffset</a>.z*<a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force.x;
<a name="l00232"></a>00232         <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque.z = <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque.z - <a class="code" href="classAerodynamics.html#a18e80d012584f2c96968b1b29aa2ff29">CGOffset</a>.y*<a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force.x + <a class="code" href="classAerodynamics.html#a18e80d012584f2c96968b1b29aa2ff29">CGOffset</a>.x*<a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.force.y;
<a name="l00233"></a>00233 
<a name="l00234"></a>00234         <span class="keywordflow">return</span> <a class="code" href="classAerodynamics.html#a823c8d510badff95ed6163b1f8f2b9ca">wrenchAero</a>.torque;
<a name="l00235"></a>00235 }
<a name="l00236"></a>00236 
<a name="l00238"></a>00238 <span class="comment">//C_lift_alpha calculation</span>
<a name="l00239"></a><a class="code" href="classStdLinearAero.html#a715cbaf04dc8b7a9c4ce4d5bf194ec8f">00239</a> <span class="keywordtype">double</span> <a class="code" href="classStdLinearAero.html#a715cbaf04dc8b7a9c4ce4d5bf194ec8f">StdLinearAero::liftCoeff</a> (<span class="keywordtype">double</span> alpha)
<a name="l00240"></a>00240 {
<a name="l00241"></a>00241         <span class="keywordtype">double</span> sigmoid = ( 1+exp(-<a class="code" href="classStdLinearAero.html#a992de56d4c416bdd05d5aea9e3d98509">M</a>*(alpha-<a class="code" href="classStdLinearAero.html#ad95e7fc62f2d7f7a5f559626fcc1a638">alpha0</a>))+exp(<a class="code" href="classStdLinearAero.html#a992de56d4c416bdd05d5aea9e3d98509">M</a>*(alpha+<a class="code" href="classStdLinearAero.html#ad95e7fc62f2d7f7a5f559626fcc1a638">alpha0</a>)) ) / (1+exp(-<a class="code" href="classStdLinearAero.html#a992de56d4c416bdd05d5aea9e3d98509">M</a>*(alpha-<a class="code" href="classStdLinearAero.html#ad95e7fc62f2d7f7a5f559626fcc1a638">alpha0</a>))) / (1+exp(<a class="code" href="classStdLinearAero.html#a992de56d4c416bdd05d5aea9e3d98509">M</a>*(alpha+<a class="code" href="classStdLinearAero.html#ad95e7fc62f2d7f7a5f559626fcc1a638">alpha0</a>)));
<a name="l00242"></a>00242         <span class="keywordtype">double</span> linear = (1.0-sigmoid) * (<a class="code" href="classStdLinearAero.html#a7a52af9ef946a13f1a9ed81e0d767a18">c_lift_0</a> + <a class="code" href="classStdLinearAero.html#ae19f9442a7fce39c46bf625732690b1d">c_lift_a0</a>*alpha); <span class="comment">//Lift at small AoA</span>
<a name="l00243"></a>00243         <span class="keywordtype">double</span> flatPlate = sigmoid*(2*copysign(1,alpha)*pow(sin(alpha),2)*cos(alpha)); <span class="comment">//Lift beyond stall</span>
<a name="l00244"></a>00244 
<a name="l00245"></a>00245         <span class="keywordtype">double</span> result  = linear+flatPlate;
<a name="l00246"></a>00246         <span class="keywordflow">return</span> result;
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00250"></a>00250 <span class="comment">//C_drag_alpha calculation</span>
<a name="l00251"></a><a class="code" href="classStdLinearAero.html#abb5b4b7352fd1ba4009844d0b66b1d11">00251</a> <span class="keywordtype">double</span> <a class="code" href="classStdLinearAero.html#abb5b4b7352fd1ba4009844d0b66b1d11">StdLinearAero::dragCoeff</a> (<span class="keywordtype">double</span> alpha)
<a name="l00252"></a>00252 {
<a name="l00253"></a>00253         <a class="code" href="classStdLinearAero.html#a001d859b3404b862e9c7ba6f498f4ce2">AR</a> = pow(<a class="code" href="classStdLinearAero.html#acdb1d08b964aff4f3bfe6c0d16710020">b</a>,2)/<a class="code" href="classStdLinearAero.html#a5cb827e9556c8a872e0333c9c6e009d9">s</a>;
<a name="l00254"></a>00254         <span class="keywordtype">double</span> c_drag_a = <a class="code" href="classStdLinearAero.html#ab01ad99b489c74890ff52a93ccff9b1f">c_drag_p</a> + pow(<a class="code" href="classStdLinearAero.html#a7a52af9ef946a13f1a9ed81e0d767a18">c_lift_0</a>+<a class="code" href="classStdLinearAero.html#ae19f9442a7fce39c46bf625732690b1d">c_lift_a0</a>*alpha,2)/(M_PI*<a class="code" href="classStdLinearAero.html#a808e6e818b50967cfb2eb710fad6a52b">oswald</a>*<a class="code" href="classStdLinearAero.html#a001d859b3404b862e9c7ba6f498f4ce2">AR</a>);
<a name="l00255"></a>00255 
<a name="l00256"></a>00256         <span class="keywordflow">return</span> c_drag_a;
<a name="l00257"></a>00257 }
<a name="l00258"></a>00258 
<a name="l00260"></a>00260 <span class="comment">// Define HCUAVAero class</span>
<a name="l00262"></a>00262 <span class="comment"></span>
<a name="l00263"></a>00263 <span class="comment">// Class constructor</span>
<a name="l00264"></a><a class="code" href="classHCUAVAero.html#aa23b775e02aa3a92f8fba2a8c1c8731e">00264</a> <a class="code" href="classHCUAVAero.html#aa23b775e02aa3a92f8fba2a8c1c8731e">HCUAVAero::HCUAVAero</a> (<a class="code" href="classModelPlane.html">ModelPlane</a> * parent) : <a class="code" href="classStdLinearAero.html">StdLinearAero</a>(parent)
<a name="l00265"></a>00265 {
<a name="l00266"></a>00266         <span class="keywordtype">char</span> <a class="code" href="classStdLinearAero.html#a5cb827e9556c8a872e0333c9c6e009d9">s</a>[100];
<a name="l00267"></a>00267         <a class="code" href="classFactory.html">Factory</a> factory;
<a name="l00268"></a>00268         <span class="comment">// Create CLift polynomial</span>
<a name="l00269"></a>00269         sprintf(s,<span class="stringliteral">&quot;%s&quot;</span>,<span class="stringliteral">&quot;airframe/cLiftPoly&quot;</span>);
<a name="l00270"></a>00270         <a class="code" href="classHCUAVAero.html#ae63ba5fbc0926e9662b69ee0ff181f43">liftCoeffPoly</a> =  factory.<a class="code" href="classFactory.html#afac44f8c128b47e742d717288e616c93">buildPolynomial</a>(s);
<a name="l00271"></a>00271         <span class="comment">// Create CDrag polynomial</span>
<a name="l00272"></a>00272         sprintf(s,<span class="stringliteral">&quot;%s&quot;</span>,<span class="stringliteral">&quot;airframe/cDragPoly&quot;</span>);
<a name="l00273"></a>00273         <a class="code" href="classHCUAVAero.html#a5a2e1b69eaa4b445672da78c8207f054">dragCoeffPoly</a> =  factory.<a class="code" href="classFactory.html#afac44f8c128b47e742d717288e616c93">buildPolynomial</a>(s);
<a name="l00274"></a>00274 }
<a name="l00275"></a>00275 
<a name="l00276"></a>00276 <span class="comment">// Class destructor</span>
<a name="l00277"></a><a class="code" href="classHCUAVAero.html#ad4037ca293cfe231877db8c78bc0efd8">00277</a> <a class="code" href="classHCUAVAero.html#ad4037ca293cfe231877db8c78bc0efd8">HCUAVAero::~HCUAVAero</a>()
<a name="l00278"></a>00278 {
<a name="l00279"></a>00279 }
<a name="l00280"></a>00280 
<a name="l00282"></a>00282 <span class="comment">//C_lift_alpha calculation</span>
<a name="l00283"></a><a class="code" href="classHCUAVAero.html#aa9da2490d019123e6764bedbcd47261d">00283</a> <span class="keywordtype">double</span> <a class="code" href="classHCUAVAero.html#aa9da2490d019123e6764bedbcd47261d">HCUAVAero::liftCoeff</a> (<span class="keywordtype">double</span> alpha)
<a name="l00284"></a>00284 {
<a name="l00285"></a>00285         <span class="keywordflow">return</span> <a class="code" href="classHCUAVAero.html#ae63ba5fbc0926e9662b69ee0ff181f43">liftCoeffPoly</a>-&gt;evaluate(alpha);
<a name="l00286"></a>00286 }
<a name="l00287"></a>00287 
<a name="l00289"></a>00289 <span class="comment">//C_drag_alpha calculation</span>
<a name="l00290"></a><a class="code" href="classHCUAVAero.html#abde35e46d15a2fc9d97c79b6698bfd9a">00290</a> <span class="keywordtype">double</span> <a class="code" href="classHCUAVAero.html#abde35e46d15a2fc9d97c79b6698bfd9a">HCUAVAero::dragCoeff</a> (<span class="keywordtype">double</span> alpha)
<a name="l00291"></a>00291 {
<a name="l00292"></a>00292         <span class="keywordflow">return</span> <a class="code" href="classHCUAVAero.html#a5a2e1b69eaa4b445672da78c8207f054">dragCoeffPoly</a>-&gt;evaluate(alpha);
<a name="l00293"></a>00293 }
</pre></div></div><!-- contents -->

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/last_letter">last_letter</a><br />
Author(s): George Zogopoulos Papaliakos <gzogop@mail.ntua.gr>, Panos Marantos</br />
<small>autogenerated on Mon Feb 23 2015 00:50:17</small>
</div>
</body>
</html>
